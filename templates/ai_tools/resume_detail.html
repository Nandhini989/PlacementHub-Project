{% extends 'base.html' %}

{% block title %}{{ resume.title }} - Placement Hub{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="mb-0">{{ resume.title }}</h2>
                        <p class="text-muted mb-0">Generated on {{ resume.generated_at|date:"M d, Y H:i" }}</p>
                    </div>
                    <div>
                        <a href="{% url 'ai_tools:resume_list' %}" class="btn btn-secondary me-2">
                            <i class="fas fa-arrow-left me-2"></i>Back to Resumes
                        </a>
                        <button class="btn btn-success" onclick="downloadResume()">
                            <i class="fas fa-download me-2"></i>Download PDF
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Resume Content -->
    <div class="row">
        <div class="col-md-9">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-file-alt me-2"></i>Resume Content</h5>
                </div>
                <div class="card-body">
                    <div class="resume-content" style="font-family: Arial, sans-serif; line-height: 1.6;">
                        {{ resume.content|linebreaks }}
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <!-- Actions -->
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0"><i class="fas fa-cog me-2"></i>Actions</h6>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-success btn-sm" onclick="downloadResume()">
                            <i class="fas fa-download me-1"></i>Download PDF
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="copyToClipboard()">
                            <i class="fas fa-copy me-1"></i>Copy Text
                        </button>
                        <button class="btn btn-info btn-sm" onclick="printResume()">
                            <i class="fas fa-print me-1"></i>Print
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tips -->
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0"><i class="fas fa-lightbulb me-2"></i>Next Steps</h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Add your specific projects
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Include work experience details
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Customize for each application
                        </li>
                        <li class="mb-0">
                            <i class="fas fa-check text-success me-2"></i>
                            Proofread carefully
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function downloadResume() {
    // Create a temporary textarea with the resume content
    const tempTextarea = document.createElement('textarea');
    tempTextarea.value = `{{ resume.content|escapejs }}`;
    document.body.appendChild(tempTextarea);
    tempTextarea.select();
    
    // Download as text file (in a real app, this would generate PDF)
    const element = document.createElement('a');
    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(tempTextarea.value));
    element.setAttribute('download', '{{ resume.title|slugify }}.txt');
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
    document.body.removeChild(tempTextarea);
}

function copyToClipboard() {
    const tempTextarea = document.createElement('textarea');
    tempTextarea.value = `{{ resume.content|escapejs }}`;
    document.body.appendChild(tempTextarea);
    tempTextarea.select();
    document.execCommand('copy');
    document.body.removeChild(tempTextarea);
    
    // Show success message
    alert('Resume content copied to clipboard!');
}

function printResume() {
    window.print();
}
</script>

<style>
@media print {
    .card-header, .btn, .navbar, .footer {
        display: none !important;
    }
    .resume-content {
        padding: 20px;
        font-size: 12pt;
    }
}
</style>
{% endblock %}
